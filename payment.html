<!DOCTYPE html>
<html>
  <head>
    <title>WTRMLN</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1" />
      <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.2/build/pure-min.css" integrity="sha384-UQiGfs9ICog+LwheBSRCt1o5cbyKIHbwjWscjemyBMT9YCUMZffs6UqUTd0hObXD" crossorigin="anonymous">
      <script src="https://2checkout.com/checkout/api/2co.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  </head>
<body>




    <div class="demo-container">
    <div class="card-wrapper"></div>


</div>
    <div class="form-container active">

        <form class="pure-form pure-form-stacked" id="myCCForm" action="paymentProduction.php" method="post">
            <input name="token" type="hidden" value="" />

            <!-- PRODUCT INFO !-->
            <input type='hidden' name="name" value='Cake'>
            <input type='hidden' name='type' value='product'>
            <input type='hidden' name='price' value='0.01'>
            <input type='hidden' name='quantity' value='1'>
            <input type='hidden' name='startupFee' value='0.00'>
            <input type='hidden' name='tangible' value='N'>

            <!-- PRODUCT OPTIONS !-->
            <!--
                <input type='hidden' name="name" value='Cookies'>
                <input type='hidden' name="productId" value='yum'>
                <input type='hidden' name="quantity" value='1'>
                <input type='hidden' name="price" value='0.00'>
                <input type='hidden' name="startupFee" value='0.00'>
                <input type='hidden' name="tangible" value='N'>
          !-->

            <!-- billingAddr !-->
            <input type="hidden" id="name" value=""/>
            <input type="hidden" name="addrLine1" value="340 Auden Ave" />
            <input type="hidden" name="city" value="Columbus"/>
            <input type="hidden" name="state" value="Ohio"/>
            <input type="hidden" name="zipCode" value="43215"/>
            <input type="hidden" name="country" value="USA"/>
            <input type="hidden" name="email" value="calebh05@gmail.com"/>
            <input type="hidden" name="phoneNumber" value="" />

            <fieldset>
                <input class="pure-input-1-1" placeholder="Cardholder Name" id="customer" name="customer" type="text" value="" />
                <input class="pure-input-1-1" placeholder="Card Number" id="number" type="text" value=""  />
                <input class="pure-input-1-1" placeholder="MM / YYYY" id="expiry" type="text" value=""/>
                <input class="pure-input-1-1" placeholder="CVV" id="cvc" type="text" value="" autocomplete="off" />
                <input class="pure-button" type="submit" value="Checkout" />
            </fieldset>

        </form>
<script>
 // Set JS Globals for expiry.
var expMonth, expYear;


  // Called when token created successfully.
  var successCallback = function(data) {
    var myForm = document.getElementById('myCCForm');


    // Set the token as the value for the token input
    myForm.token.value = data.response.token.token;

    // IMPORTANT: Here we call `submit()` on the form element directly instead of using jQuery to prevent and infinite token request loop.
    myForm.submit();
  };

  // Called when token creation fails.
  var errorCallback = function(data) {
    // Retry the token request if ajax call fails
    if (data.errorCode === 200) {
       // This error code indicates that the ajax call failed. We recommend that you retry the token request.
    } else {
      alert(data.errorMsg);
    }
  };


  var tokenRequest = function() {

        // Set expiry, one input to two var's via .slice
       var expiry = document.getElementById("expiry").value;
       var expMonth = expiry.slice(0, 2);
       var expYear = expiry.slice(5, 9); 


    // Setup token request arguments
    var args = {
      sellerId: '102557782',
      publishableKey: '2B2F62D0-D951-40A9-B383-24C9AD4848BE',
      ccNo: $("#number").val(),
      cvv: $("#cvc").val(),
      expMonth: expMonth,    // $("#expMonth").val(), by default
      expYear: expYear        // $("#expYear").val(), by default
    };

    // Make the token request
    TCO.requestToken(successCallback, errorCallback, args);
  };

  $(function() {
    // Pull in the public encryption key for our environment
      TCO.loadPubKey('production');

    $("#myCCForm").submit(function(e) {
      // Call our token request function
      tokenRequest();

      // Prevent form from submitting
      return false;
    });
  });
</script>
<script src="/tcoCard/tcoCard/card/dist/card.js"></script>
<script>
        new Card({
            form: document.querySelector('form'),
            container: '.card-wrapper'
});
</script>
                <!-- Footer -->
                    <footer id="footer">
                        <span class="copyright">&copy; <a href="http://wtrmln.net">WTRMLN</a></span>
                    </footer>
    </body>
</html>
